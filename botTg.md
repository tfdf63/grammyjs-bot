# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telegram-–±–æ—Ç–∞

## –û–ø–∏—Å–∞–Ω–∏–µ

Telegram-–±–æ—Ç –¥–ª—è –§–ö "–ê–∫—Ä–æ–Ω" —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –Ω–∞ –±–∞–∑–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ **Grammy.js**. –ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∏–ª–µ—Ç–∞—Ö –Ω–∞ –º–∞—Ç—á–∏ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç QR-–∫–æ–¥—ã —Å UTM-–º–µ—Ç–∫–∞–º–∏ –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ index.js      # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ constants.js  # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ authService.js    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è API
‚îÇ   ‚îú‚îÄ‚îÄ ticketsService.js # –†–∞–±–æ—Ç–∞ —Å –±–∏–ª–µ—Ç–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ qrCodeService.js  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤
‚îú‚îÄ‚îÄ handlers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ commonHandler.js  # –û–±—â–∏–µ –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ ticketsHandler.js # –ö–æ–º–∞–Ω–¥—ã –±–∏–ª–µ—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ qrCodeHandler.js  # –ö–æ–º–∞–Ω–¥—ã QR-–∫–æ–¥–æ–≤
‚îú‚îÄ‚îÄ middleware/       # Middleware
‚îÇ   ‚îú‚îÄ‚îÄ logger.js         # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.js   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ validators.js     # –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ formatters.js     # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ timeUtils.js      # –†–∞–±–æ—Ç–∞ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
‚îú‚îÄ‚îÄ scheduler/        # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ reportScheduler.js # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—á–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ bot.js            # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –±–æ—Ç–∞
‚îî‚îÄ‚îÄ index.js          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### `/start`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è  
**–û–±—Ä–∞–±–æ—Ç—á–∏–∫:** `CommonHandler.handleStartCommand()`  
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –í—ã–≤–æ–¥–∏—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é üëç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ

**–û—Ç–≤–µ—Ç –±–æ—Ç–∞:**
```
–ü—Ä–∏–≤–µ—Ç! –Ø - –±–æ—Ç –§–ö "–ê–∫—Ä–æ–Ω". –ú–æ–ª–æ–¥–æ–π –∏ –∑–≤–æ–Ω–∫–∏–π! [–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è!]

üéØ –¢–∞–∫–∂–µ —è —É–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å QR-–∫–æ–¥—ã —Å UTM –º–µ—Ç–∫–∞–º–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤.

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
/tickets - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∏–ª–µ—Ç–∞—Ö
/qrcode - –°–æ–∑–¥–∞—Ç—å QR-–∫–æ–¥ —Å UTM –º–µ—Ç–∫–æ–π
```

### `/tickets`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–∏–ª–µ—Ç–∞—Ö –ø–æ –≤—Å–µ–º –º–∞—Ç—á–∞–º  
**–û–±—Ä–∞–±–æ—Ç—á–∏–∫:** `TicketsHandler.handleTicketsCommand()`  
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –±–∏–ª–µ—Ç–∞—Ö –¥–ª—è –≤—Å–µ—Ö –º–∞—Ç—á–µ–π –∏–∑ —Ñ–∞–π–ª–∞ `matches.js`
- –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ HTML —Ñ–æ—Ä–º–∞—Ç–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É –º–∞—Ç—á—É:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã—Ö
  - –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂
  - –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –±–∏–ª–µ—Ç–∞
  - –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
```html
<b>–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ë–ò–õ–ï–¢–ê–• –ü–û –í–°–ï–ú –ú–ê–¢–ß–ê–ú</b>

<b>–ê–∫—Ä–æ–Ω —Ö –°–æ—á–∏ // 21.11.2025</b>

–ü—Ä–æ–¥–∞–Ω–æ: <b>1 234</b>
–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã—Ö: <b>56</b>
–°—É–º–º–∞: <b>2 345 678 ‚ÇΩ</b>
–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: <b>1 900 ‚ÇΩ</b>

–ü–ª–∞–Ω: <b>3 076 000 ‚ÇΩ</b>
–í—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞: <b>76%</b>
–ò—Ç–æ–≥–æ: <b>1 290</b>
```

### `/qrcode`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ QR-–∫–æ–¥–∞ —Å UTM-–º–µ—Ç–∫–æ–π  
**–û–±—Ä–∞–±–æ—Ç—á–∏–∫:** `QRCodeHandler.handleQRCodeCommand()`  
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è QR-–∫–æ–¥–∞
- –ü–æ—à–∞–≥–æ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ —Å–µ—Å—Å–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ PNG –∏ JPG
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫ —Å—Å—ã–ª–∫–µ

**–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è QR-–∫–æ–¥–∞:**
1. **–í–≤–æ–¥ URL** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É
2. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ URL** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
3. **–í–≤–æ–¥ UTM-–º–µ—Ç–∫–∏** - —É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–∏
4. **–í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞** - PNG (–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω) –∏–ª–∏ JPG (–±–µ–ª—ã–π —Ñ–æ–Ω)
5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞** - —Å–æ–∑–¥–∞–Ω–∏–µ QR-–∫–æ–¥–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞

**UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `utm_medium=qrcode`
- `utm_campaign={—É–∫–∞–∑–∞–Ω–Ω–∞—è_–º–µ—Ç–∫–∞}`

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /qrcode
–ë–æ—Ç: üîó –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å QR-–∫–æ–¥

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: https://example.com
–ë–æ—Ç: üîó –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É: [—Å—Å—ã–ª–∫–∞]
     [‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å] [‚úèÔ∏è –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
–ë–æ—Ç: üè∑Ô∏è –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å—Ç–µ UTM –º–µ—Ç–∫—É –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: summer_sale
–ë–æ—Ç: ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Å—ã–ª–∫–∞ —Å UTM –º–µ—Ç–∫–∞–º–∏:
     [üì± PNG (–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω)] [üñºÔ∏è JPG (–±–µ–ª—ã–π —Ñ–æ–Ω)]
     [‚úèÔ∏è –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å UTM]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: üì± PNG (–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω)
–ë–æ—Ç: [–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª QR-–∫–æ–¥–∞]
```

### `/test_channel`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞ –≤ –∫–∞–Ω–∞–ª  
**–û–±—Ä–∞–±–æ—Ç—á–∏–∫:** `TicketsHandler.handleTestChannelCommand()`  
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–∏–ª–µ—Ç–∞—Ö –≤ –∫–∞–Ω–∞–ª
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

## –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Å—Å–∏–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ QR-–∫–æ–¥–∞:

```javascript
{
  step: null,              // –¢–µ–∫—É—â–∏–π —à–∞–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞
  url: null,               // –í–≤–µ–¥–µ–Ω–Ω—ã–π URL
  utmTag: null,            // UTM –º–µ—Ç–∫–∞
  finalUrl: null,          // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Å—ã–ª–∫–∞ —Å UTM
  format: 'png'            // –§–æ—Ä–º–∞—Ç QR-–∫–æ–¥–∞
}
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (sessionStates):**
- `WAITING_URL` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ URL
- `WAITING_URL_CONFIRMATION` - –æ–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è URL
- `WAITING_UTM` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ UTM-–º–µ—Ç–∫–∏
- `WAITING_CONFIRMATION` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–≥–∞—Ç–µ–ª—å—Å—Ç–≤
**–¢—Ä–∏–≥–≥–µ—Ä:** –°–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–ª–æ–≤–æ "–ø–∏–ø–µ—Ü"  
**–û–±—Ä–∞–±–æ—Ç—á–∏–∫:** `CommonHandler.handleSwearing()`  
**–û—Ç–≤–µ—Ç:** "–†—É–≥–∞–µ–º—Å—è?"

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:** `ReportScheduler`  
**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 11:00 –ø–æ —Å–∞–º–∞—Ä—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ (UTC+4)  
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á–µ—Ç –æ –±–∏–ª–µ—Ç–∞—Ö –≤ –∫–∞–Ω–∞–ª
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—à–∏–±–∫–∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
BOT_API_KEY=your_telegram_bot_token        # –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
BOT_TICKETS_LOGIN=your_login               # –õ–æ–≥–∏–Ω –¥–ª—è API –±–∏–ª–µ—Ç–æ–≤
BOT_TICKETS_PASSWORD=your_password         # –ü–∞—Ä–æ–ª—å –¥–ª—è API –±–∏–ª–µ—Ç–æ–≤
CHANNEL_ID=your_channel_id                 # ID –∫–∞–Ω–∞–ª–∞ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ (src/config/index.js)

```javascript
bot: {
  token: process.env.BOT_API_KEY,
  channelId: process.env.CHANNEL_ID || '-1002396067751',
},
timezone: {
  offset: 4,  // –°–∞–º–∞—Ä–∞ UTC+4
},
qrCode: {
  defaultFormat: 'png',
  defaultSize: 512,
  quality: 0.92,
  margin: 1,
},
scheduler: {
  reportHour: 11,              // –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á–µ—Ç–∞ (11:00)
  checkInterval: 60 * 1000,    // –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (1 –º–∏–Ω—É—Ç–∞)
},
```

## –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
npm run dev
```

### Production —Ä–µ–∂–∏–º
```bash
npm start
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2 (ecosystem)
```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run pm2:start

# –ü—Ä–æ–¥–∞–∫—à–Ω
pm2 start ecosystem.prod.config.js
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PM2
```bash
npm run pm2:stop      # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
npm run pm2:restart   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
npm run pm2:logs      # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
npm run pm2:monit     # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
npm run pm2:delete    # –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤
- `logs/telegram-bot.log` - –õ–æ–≥–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å –±–æ—Ç–æ–º
- `logs/pm2.log` - –õ–æ–≥–∏ PM2 –ø—Ä–æ—Ü–µ—Å—Å–∞
- `logs/pm2-out.log` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥
- `logs/pm2-error.log` - –û—à–∏–±–∫–∏

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤
```
[2025-11-20 15:30:45] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username (–ò–º—è –§–∞–º–∏–ª–∏—è, ID: 123456) | –ó–∞–ø—Ä–æ—Å: /tickets
[2025-11-20 15:30:45] [INFO] –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –æ –±–∏–ª–µ—Ç–∞—Ö –≤ –∫–∞–Ω–∞–ª...
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **INFO** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–µ–ª–µ–Ω—ã–π)
- **WARN** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–∂–µ–ª—Ç—ã–π)
- **ERROR** - –æ—à–∏–±–∫–∏ (–∫—Ä–∞—Å–Ω—ã–π)

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫
1. **GrammyError** - –æ—à–∏–±–∫–∏ Telegram API
   - –û—Ç–≤–µ—Ç: "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ Telegram API. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

2. **HttpError** - –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏
   - –û—Ç–≤–µ—Ç: "‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É."

3. **API Error** - –æ—à–∏–±–∫–∏ API –±–∏–ª–µ—Ç–æ–≤
   - –û—Ç–≤–µ—Ç: "–û—à–∏–±–∫–∞ API —Å–µ—Ä–≤–∏—Å–∞ –±–∏–ª–µ—Ç–æ–≤"

4. **Unknown Error** - –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏
   - –û—Ç–≤–µ—Ç: "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

### Graceful Shutdown

–ë–æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
- `SIGINT` (Ctrl+C)
- `SIGTERM`

–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞:
1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—á–µ—Ç–æ–≤
2. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –±–æ—Ç
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

## –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –í–∞–ª–∏–¥–∞—Ü–∏—è URL
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ `http://` –∏–ª–∏ `https://`
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ URL

### –í–∞–ª–∏–¥–∞—Ü–∏—è UTM-–º–µ—Ç–∫–∏
- –ù–µ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã
- –î–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã: –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è, –¥–µ—Ñ–∏—Å—ã
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `/^[a-zA-Z0-9_-]+$/`

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ QR-–∫–æ–¥–∞
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: `png`, `jpg`

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `grammy` - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram-–±–æ—Ç–æ–≤
- `qrcode` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤
- `node-fetch` - HTTP-–∑–∞–ø—Ä–æ—Å—ã
- `dotenv` - —Ä–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- `nodemon` - –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- `pm2` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞—Ç—á–µ–π

–ú–∞—Ç—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `matches.js`:

```javascript
{
  eventId: 48450863,                    // ID —Å–æ–±—ã—Ç–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –±–∏–ª–µ—Ç–æ–≤
  game: '–ê–∫—Ä–æ–Ω —Ö –°–æ—á–∏ // 21.11.2025',   // –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ç—á–∞
  planTickets: 8000,                     // –ü–ª–∞–Ω –ø–æ –±–∏–ª–µ—Ç–∞–º
  planRevenue: 3076000,                  // –ü–ª–∞–Ω –ø–æ –≤—ã—Ä—É—á–∫–µ
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
2. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –≤—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏** - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã QR-–∫–æ–¥–æ–≤ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
4. **Graceful shutdown** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### PM2 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
pm2 monit                    # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 status                   # –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 logs tg-grammy-tickets-bot  # –õ–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- –ö–æ–º–∞–Ω–¥–∞ `/test_channel` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –∫–∞–Ω–∞–ª
- –õ–æ–≥–∏ –≤ `logs/telegram-bot.log`
- PM2 –ª–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

